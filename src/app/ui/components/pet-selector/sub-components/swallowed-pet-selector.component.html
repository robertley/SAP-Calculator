<ng-container [formGroup]="formGroup">
    <!-- Abomination Swallowed Pets -->
    <div class="col-12 mb-2" *ngIf="pet?.name === 'Abomination'">
        <div *ngFor="let a of [].constructor(pet.level); index as i; trackBy: trackByIndex">
            <div class="swallowed-slot mb-2">
                <label class="swallowed-label">Swallowed Pet {{ i + 1 }}</label>
                <div class="d-flex align-items-center gap-2">
                    <button type="button" class="btn selection-btn flex-grow-1 d-flex align-items-center"
                        (click)="openSelectionDialog('swallowed-pet', i + 1, 'abomination')">
                        <img *ngIf="getPetImagePath(formGroup.get('abominationSwallowedPet' + (i + 1))?.value)"
                            class="selection-icon"
                            [ngSrc]="getPetImagePath(formGroup.get('abominationSwallowedPet' + (i + 1))?.value)!"
                            width="24" height="24" loading="lazy" decoding="async" alt="Swallowed Pet" />
                        <span class="selection-text">{{ formGroup.get('abominationSwallowedPet' + (i + 1))?.value ||
                            'None' }}</span>
                        <i class="fas fa-chevron-down ms-auto"></i>
                    </button>
                </div>

                <div class="swallowed-nested mt-2 ps-3 border-start" *ngIf="
                    formGroup.get('abominationSwallowedPet' + (i + 1))?.value &&
                    (
                      showSwallowedLevels ||
                      shouldShowAbominationSwallowTimesHurt(i) ||
                      formGroup.get('abominationSwallowedPet' + (i + 1))?.value === 'Beluga Whale' ||
                      formGroup.get('abominationSwallowedPet' + (i + 1))?.value === 'Parrot'
                    )
                  ">
                    <!-- Nested Level for Swallowed Pet -->
                    <div class="form-group small-w-input mb-2" *ngIf="showSwallowedLevels || pet?.name === 'Abomination'">
                        <label class="swallowed-label-small">Level</label>
                        <select class="form-control form-control-sm"
                            [formControlName]="'abominationSwallowedPet' + (i + 1) + 'Level'">
                            <option [ngValue]="1">1</option>
                            <option [ngValue]="2">2</option>
                            <option [ngValue]="3">3</option>
                        </select>
                    </div>

                    <!-- Times Hurt (Tuna) -->
                    <div class="form-group small-w-input mb-2" *ngIf="shouldShowAbominationSwallowTimesHurt(i)">
                        <label class="swallowed-label-small">Times Hurt</label>
                        <input class="form-control form-control-sm" type="number" min="0" max="99"
                            [formControlName]="'abominationSwallowedPet' + (i + 1) + 'TimesHurt'" />
                    </div>

                    <!-- Beluga inside Abomination -->
                    <div class="nested-selection mb-2"
                        *ngIf="formGroup.get('abominationSwallowedPet' + (i + 1))?.value === 'Beluga Whale'">
                        <label class="swallowed-label-small">Swallowed by Beluga</label>
                        <button type="button" class="btn selection-btn btn-sm w-100 d-flex align-items-center"
                            (click)="openSelectionDialog('swallowed-pet', i + 1, 'abomination-beluga')">
                            <img *ngIf="getPetImagePath(formGroup.get('abominationSwallowedPet' + (i + 1) + 'BelugaSwallowedPet')?.value)"
                                class="selection-icon"
                                [ngSrc]="getPetImagePath(formGroup.get('abominationSwallowedPet' + (i + 1) + 'BelugaSwallowedPet')?.value)!"
                                width="20" height="20" loading="lazy" decoding="async" alt="Beluga Swallowed Pet" />
                            <span class="selection-text">{{ formGroup.get('abominationSwallowedPet' + (i + 1) +
                                'BelugaSwallowedPet')?.value || 'None' }}</span>
                            <i class="fas fa-chevron-down ms-auto"></i>
                        </button>
                    </div>

                    <!-- Parrot inside Abomination -->
                    <div class="nested-selection"
                        *ngIf="formGroup.get('abominationSwallowedPet' + (i + 1))?.value === 'Parrot'">
                        <label class="swallowed-label-small">Parrot Copy</label>
                        <button type="button" class="btn selection-btn btn-sm w-100 d-flex align-items-center"
                            (click)="openSelectionDialog('swallowed-pet', i + 1, 'abomination-parrot')">
                            <img *ngIf="getPetImagePath(formGroup.get('abominationSwallowedPet' + (i + 1) + 'ParrotCopyPet')?.value)"
                                class="selection-icon"
                                [ngSrc]="getPetImagePath(formGroup.get('abominationSwallowedPet' + (i + 1) + 'ParrotCopyPet')?.value)!"
                                width="20" height="20" loading="lazy" decoding="async" alt="Parrot Copy Pet" />
                            <span class="selection-text">{{ formGroup.get('abominationSwallowedPet' + (i + 1) +
                                'ParrotCopyPet')?.value || 'None' }}</span>
                            <i class="fas fa-chevron-down ms-auto"></i>
                        </button>

                        <!-- Nested Beluga inside Parrot inside Abomination -->
                        <div class="mt-2 ps-2 border-start"
                            *ngIf="formGroup.get('abominationSwallowedPet' + (i + 1) + 'ParrotCopyPet')?.value === 'Beluga Whale'">
                            <label class="swallowed-label-small">Then Beluga Swallow</label>
                            <button type="button" class="btn selection-btn btn-sm w-100 d-flex align-items-center"
                                (click)="openSelectionDialog('swallowed-pet', i + 1, 'abomination-parrot-beluga')">
                                <img *ngIf="getPetImagePath(formGroup.get('abominationSwallowedPet' + (i + 1) + 'ParrotCopyPetBelugaSwallowedPet')?.value)"
                                    class="selection-icon"
                                    [ngSrc]="getPetImagePath(formGroup.get('abominationSwallowedPet' + (i + 1) + 'ParrotCopyPetBelugaSwallowedPet')?.value)!"
                                    width="20" height="20" loading="lazy" decoding="async" alt="Nested Beluga" />
                                <span class="selection-text">{{ formGroup.get('abominationSwallowedPet' + (i + 1) +
                                    'ParrotCopyPetBelugaSwallowedPet')?.value || 'None' }}</span>
                                <i class="fas fa-chevron-down ms-auto"></i>
                            </button>
                        </div>

                        <!-- Nested Abomination inside Parrot inside Abomination -->
                        <div class="mt-2 ps-2 border-start"
                            *ngIf="formGroup.get('abominationSwallowedPet' + (i + 1) + 'ParrotCopyPet')?.value === 'Abomination'">
                            <div class="form-group small-w-input mb-2">
                                <label class="swallowed-label-small">Nested Abom Level</label>
                                <select class="form-control form-control-sm"
                                    [formControlName]="'abominationSwallowedPet' + (i + 1) + 'ParrotCopyPetAbominationLevel'">
                                    <option [ngValue]="1">1</option>
                                    <option [ngValue]="2">2</option>
                                    <option [ngValue]="3">3</option>
                                </select>
                            </div>
                            <div
                                *ngFor="let b of [].constructor(formGroup.get('abominationSwallowedPet' + (i + 1) + 'ParrotCopyPetAbominationLevel')?.value || 1); index as j; trackBy: trackByIndex">
                                <label class="swallowed-label-small">Nested Slot {{ j + 1 }}</label>
                                <button type="button"
                                    class="btn selection-btn btn-sm w-100 d-flex align-items-center mb-1"
                                    (click)="openSelectionDialog('swallowed-pet', i + 1, 'abomination-parrot-abomination', j + 1)">
                                    <img *ngIf="getPetImagePath(formGroup.get('abominationSwallowedPet' + (i + 1) + 'ParrotCopyPetAbominationSwallowedPet' + (j + 1))?.value)"
                                        class="selection-icon"
                                        [ngSrc]="getPetImagePath(formGroup.get('abominationSwallowedPet' + (i + 1) + 'ParrotCopyPetAbominationSwallowedPet' + (j + 1))?.value)!"
                                        width="20" height="20" loading="lazy" decoding="async" alt="Nested Abom Slot" />
                                    <span class="selection-text">{{ formGroup.get('abominationSwallowedPet' + (i + 1) +
                                        'ParrotCopyPetAbominationSwallowedPet' + (j + 1))?.value || 'None' }}</span>
                                    <i class="fas fa-chevron-down ms-auto"></i>
                                </button>
                                <div class="form-group small-w-input mb-1 ms-2"
                                    *ngIf="shouldShowAbominationParrotCopyAbominationTimesHurt(i + 1, j + 1)">
                                    <label class="swallowed-label-tiny">Times Hurt</label>
                                    <input class="form-control form-control-sm" type="number" min="0" max="99"
                                        [formControlName]="'abominationSwallowedPet' + (i + 1) + 'ParrotCopyPetAbominationSwallowedPet' + (j + 1) + 'TimesHurt'" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Regular Beluga Whale / Parrot / Sarcastic Fringehead in main pet position -->
    <div class="col-12 mb-2">
        <div *ngIf="pet?.name === 'Beluga Whale'">
            <label class="swallowed-label">Swallowed by Beluga</label>
            <button type="button" class="btn selection-btn w-100 d-flex align-items-center"
                (click)="openSelectionDialog('swallowed-pet', undefined, 'pet')">
                <img *ngIf="getPetImagePath(formGroup.get('belugaSwallowedPet')?.value)" class="selection-icon"
                    [ngSrc]="getPetImagePath(formGroup.get('belugaSwallowedPet')?.value)!" width="24" height="24"
                    loading="lazy" decoding="async" alt="Beluga Swallowed" />
                <span class="selection-text">{{ formGroup.get('belugaSwallowedPet')?.value || 'Select Pet' }}</span>
                <i class="fas fa-chevron-down ms-auto"></i>
            </button>
        </div>

        <div *ngIf="pet?.name === 'Parrot'">
            <label class="swallowed-label">Parrot Copy</label>
            <button type="button" class="btn selection-btn w-100 d-flex align-items-center"
                (click)="openSelectionDialog('swallowed-pet', undefined, 'parrot')">
                <img *ngIf="getPetImagePath(formGroup.get('parrotCopyPet')?.value)" class="selection-icon"
                    [ngSrc]="getPetImagePath(formGroup.get('parrotCopyPet')?.value)!" width="24" height="24"
                    loading="lazy" decoding="async" alt="Parrot Copy" />
                <span class="selection-text">{{ formGroup.get('parrotCopyPet')?.value || 'Select Pet' }}</span>
                <i class="fas fa-chevron-down ms-auto"></i>
            </button>

            <!-- Beluga inside Parrot -->
            <div class="mt-2 ps-3 border-start" *ngIf="formGroup.get('parrotCopyPet')?.value === 'Beluga Whale'">
                <label class="swallowed-label">Then Beluga Swallow</label>
                <button type="button" class="btn selection-btn w-100 d-flex align-items-center"
                    (click)="openSelectionDialog('swallowed-pet', undefined, 'parrot-beluga')">
                    <img *ngIf="getPetImagePath(formGroup.get('parrotCopyPetBelugaSwallowedPet')?.value)"
                        class="selection-icon"
                        [ngSrc]="getPetImagePath(formGroup.get('parrotCopyPetBelugaSwallowedPet')?.value)!" width="24"
                        height="24" loading="lazy" decoding="async" alt="Nested Beluga" />
                    <span class="selection-text">{{ formGroup.get('parrotCopyPetBelugaSwallowedPet')?.value || 'Select
                        Pet' }}</span>
                    <i class="fas fa-chevron-down ms-auto"></i>
                </button>
            </div>

            <!-- Abomination inside Parrot -->
            <div class="mt-2 ps-3 border-start" *ngIf="formGroup.get('parrotCopyPet')?.value === 'Abomination'">
                <div class="form-group small-w-input mb-2">
                    <label class="swallowed-label">Abom Level</label>
                    <select class="form-control" formControlName="parrotCopyPetAbominationLevel">
                        <option [ngValue]="1">1</option>
                        <option [ngValue]="2">2</option>
                        <option [ngValue]="3">3</option>
                    </select>
                </div>
                <div
                    *ngFor="let foo of [].constructor(getParrotCopyAbominationSlotCount()); index as i; trackBy: trackByIndex">
                    <label class="swallowed-label">Swallowed Pet {{ i+1 }}</label>
                    <button type="button" class="btn selection-btn w-100 d-flex align-items-center mb-2"
                        (click)="openSelectionDialog('swallowed-pet', i+1, 'parrot-abomination')">
                        <img *ngIf="getPetImagePath(formGroup.get('parrotCopyPetAbominationSwallowedPet' + (i+1))?.value)"
                            class="selection-icon"
                            [ngSrc]="getPetImagePath(formGroup.get('parrotCopyPetAbominationSwallowedPet' + (i+1))?.value)!"
                            width="24" height="24" loading="lazy" decoding="async" alt="Nested Abom Slot" />
                        <span class="selection-text">{{ formGroup.get('parrotCopyPetAbominationSwallowedPet' +
                            (i+1))?.value || 'None' }}</span>
                        <i class="fas fa-chevron-down ms-auto"></i>
                    </button>
                    <div class="form-group small-w-input mb-2 ms-3"
                        *ngIf="shouldShowParrotCopyPetAbominationTimesHurt(i + 1)">
                        <label class="swallowed-label-small">Times Hurt</label>
                        <input class="form-control form-control-sm" type="number" min="0" max="99"
                            [formControlName]="'parrotCopyPetAbominationSwallowedPet' + (i+1) + 'TimesHurt'" />
                    </div>
                </div>
            </div>
        </div>

        <div *ngIf="pet?.name === 'Sarcastic Fringehead'">
            <label class="swallowed-label">Swallowed by Fringehead</label>
            <button type="button" class="btn selection-btn w-100 d-flex align-items-center"
                (click)="openSelectionDialog('swallowed-pet', undefined, 'pet')">
                <img *ngIf="getPetImagePath(formGroup.get('sarcasticFringeheadSwallowedPet')?.value)"
                    class="selection-icon"
                    [ngSrc]="getPetImagePath(formGroup.get('sarcasticFringeheadSwallowedPet')?.value)!" width="24"
                    height="24" loading="lazy" decoding="async" alt="Fringehead Swallowed" />
                <span class="selection-text">{{ formGroup.get('sarcasticFringeheadSwallowedPet')?.value || 'Select Pet'
                    }}</span>
                <i class="fas fa-chevron-down ms-auto"></i>
            </button>
        </div>
    </div>
</ng-container>
