"use strict";(self.webpackChunksap_calculator=self.webpackChunksap_calculator||[]).push([[56],{56(g,c,a){a.d(c,{ExportCalculatorComponent:()=>f});var n=a(9769),u=a(3446),t=a(5547),p=a(4937);function m(o,_){if(1&o&&(t.j41(0,"div",4),t.EFF(1),t.k0s()),2&o){const e=t.XpG();t.Y8G("ngClass","success"===e.statusTone?"text-success":"text-danger"),t.R7$(),t.SpI(" ",e.statusMessage," ")}}let f=(()=>{class o{localStorageService;formGroup;statusMessage="";statusTone="success";statusTimer=null;constructor(e){this.localStorageService=e}ngOnInit(){}formGroupValueString(){if(!this.formGroup)return"";try{const r=(0,u.A)(this.formGroup.value),i=[...r.playerPets||[],...r.opponentPets||[]];for(const s of i)if(s&&(delete s.parent,delete s.logService,delete s.abilityService,delete s.gameService,delete s.petService,s.equipment)){const l="string"==typeof s.equipment?s.equipment:s.equipment.name;s.equipment=l?{name:l}:null}return JSON.stringify(r,null,2)}catch(e){return console.error("Error creating export string:",e),"Error: Could not generate the export data."}}copyToClipboard(){this.localStorageService.setFormStorage(this.formGroup),this.clearStatus();const e=this.formGroupValueString();e.startsWith("Error:")?this.setStatus("Failed to export.","error"):navigator.clipboard.writeText(e).then(()=>{this.setStatus("Copied to clipboard.","success")}).catch(r=>{console.error("Clipboard error:",r),this.setStatus("Failed to copy to clipboard.","error")})}clearStatus(){this.statusTimer&&(clearTimeout(this.statusTimer),this.statusTimer=null),this.statusMessage=""}setStatus(e,r){this.statusMessage=e,this.statusTone=r,this.statusTimer&&clearTimeout(this.statusTimer),this.statusTimer=setTimeout(()=>{this.statusMessage="",this.statusTimer=null},3e3)}static \u0275fac=function(r){return new(r||o)(t.rXU(p.s))};static \u0275cmp=t.VBU({type:o,selectors:[["app-export-calculator"]],inputs:{formGroup:"formGroup"},decls:5,vars:2,consts:[[1,"form-group"],["id","calcCode","rows","8","readonly","",1,"form-control","mb-2","calc-textarea",3,"value"],[1,"btn","btn-primary",3,"click"],["class","mt-2",3,"ngClass",4,"ngIf"],[1,"mt-2",3,"ngClass"]],template:function(r,i){1&r&&(t.j41(0,"div",0),t.nrm(1,"textarea",1),t.j41(2,"button",2),t.bIt("click",function(){return i.copyToClipboard()}),t.EFF(3," Copy to Clipboard "),t.k0s(),t.DNE(4,m,2,2,"div",3),t.k0s()),2&r&&(t.R7$(),t.Y8G("value",i.formGroupValueString()),t.R7$(3),t.Y8G("ngIf",i.statusMessage))},dependencies:[n.MD,n.YU,n.bT],styles:[".calc-textarea[_ngcontent-%COMP%]{min-height:180px;font-family:Courier New,Courier,monospace;white-space:pre;overflow-wrap:normal;overflow:auto;resize:vertical}"]})}return o})()}}]);